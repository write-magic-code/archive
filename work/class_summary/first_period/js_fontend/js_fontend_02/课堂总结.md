# 02 尝试在 codesandbox 上写你的第一个 React App

> 课程目的
>
> - 跑起来一个简单的 React 项目——借由 codesandbox
> - 了解 React 的基本概念
> - 了解 React 组件的组成结构

## 起一个简单的 React 项目

<center>
<img src="./react.svg" width="50%">
</center>

**React** 是当前世界上使用人数最多的前端框架，没有之一。他能更好地构建高效的、易于维护的 UI。

**Codesandbox** 是一个运行在网页上的前端开发平台，可以在上面直接写代码（而无需花时间配置环境），然后直接在浏览器里看到效果，因此非常适合教学场景（之后的课程会讲到如何创建项目）。

可以直接打开 `https://react.new`，就能在 codesandbox 里自动新建一个 React 项目。

**[执行]** Codesandbox 左侧编辑器的 `src` 目录下的文件。

然后点击右侧的 preview，就能看到项目跑起来了。

## React 的基本概念

### JSX

JSX 是一种 React 中常用的 JS 语法扩展，看起来像 HTML，但实质上是 JavaScript。它让你在 JavaScript 代码中写类似 HTML 的标签，利用这些类似 HTML 的语法可以直观的描述 HTML 的结构。  

比如：

```jsx
const element = <div>hello world<div>;
```
和
```jsx
const element = React.createElement('div', null, 'Hello, world!')
```
是等价的。

JSX 不仅支持类似 html 标签的简洁表述，还支持插入 js 表达式。比如：
```jsx
  const text = "world";
  const element = <div>Hello, {text}!</div>;
```

**你可以在 JSX 的大括号`{}`内写任何 js 表达式。**   
你可以往里**加入函数、循环判断等等一切 js 语法支持的内容**——只要最后它能构成一个表达式（而不是多个，或非表达式）

这当然无法在浏览器直接运行，但是它可以被某些工具翻译为合法的 js 代码，以便浏览器执行。  
大部分时候你无需关心这个过程，只需要享受在 js 里写 html 的带来的效率提升。

## 组件

为了复用、可维护、美观等一系列理由，你需要用少量组件，而不是上万个元素去描述一个页面。  
组件有两种写法，**类组件 class component** 和 **函数组件 functional component**。这次只介绍函数组件，因为类组件被淘汰了。  
一个函数组件构成如下：

```jsx
const Component = (props) => {
  const text = '你一定要幸福啊'
  return <div>Hello, {props.name}! {text}!</div>;
};
```
- props: 组件属性（即函数的输入）
- body: 函数体，可以定义变量、状态等
- return: 组件返回的元素，包含交互逻辑、样式等

一个函数组件名必须大写，这是为了和一般 html 标签区分开。当定义了函数组件后，它就会被翻译为一个“自定义标签”，然后就可以在 JSX 中使用它，就像这样：

```jsx
<div>
  <Component name="world" />
</div>
```
**因此，你应该理解如何在 React 里，定义组件、使用组件、所谓“自定义组件名”和“组件自定义props（属性名）”这些事了。**  

## 接近工业标准的 JSX

假设一个场景，一个一般页面的结构可能如下：

1. 顶部一个导航栏，由链接和按钮组成
2. 下面分两栏，左侧是侧边栏，右侧是主要内容
3. 侧边栏里有一个目录
4. 主要内容里有一篇文章

实现效果：

[complex.png](./complex.png)

自己来实现一下：

[complex.jsx](./complex.jsx)

## 条件渲染与列表渲染

因为 jsx 里面可以使用 `{}` 来插入任何 js 表达式，所以，在 React 中，可以使用 js 的条件语句和循环语句来控制组件的渲染。

### 条件渲染

可以使用 js 的条件语句来控制组件的渲染，比如下面的例子，根据 `isLogin` 的值来决定显示不同的内容。

```jsx
const App = () => {
  const [isLogin, setIsLogin] = useState(false);

  return (
    <div>
      {isLogin ? <div>欢迎回来</div> : <div>请登录</div>}
      <button onClick={() => setIsLogin(!isLogin)}>登录/登出</button>
      {isLogin && <div>这是登录后才能看到的内容</div>}
    </div>
  );
}
```

### 列表渲染

使用 `map` 函数来遍历数组，生成一个包含着 jsx 的数组，然后可以使用 `{}` 来将这个 jsx 数组插入到 jsx 中。

```jsx
const list = ['apple', 'banana', 'cherry'];

const App = () => {
  return (
    <div>
      <ul>
        {list.map((item, index) => (
          <li key={index}>{item}</li>
        ))}
      </ul>
    </div>
  );
}
```

因为 React 需要一个 key 来区分每个元素来做性能优化，所们需要给每个元素一个 key，这个 key 一般是一个唯一的标识符，比如 id，否则 React 会报错。

## 渲染

前面提到，jsx 会被翻译成一个包含着标签（组件）、属性、子元素的对象，这个对象叫做 `ReactNode`。

React 的渲染过程就是将整个组件树中的 `ReactNode` 计算出来，从最顶层一直算到最底层，将所有的组件都最终换成 DOM 元素，得到一个虚拟的 DOM 结构，最后算出跟当前页面 DOM 结构的差异，然后更新页面。

## 状态与页面更新

目前写的组件都是死板的静态的，页面自渲染之后就固定的，不会有任何变化，但是这在实际的应用中是不够的。

在 React 世界，页面的更新由**状态更新**来触发，因此一个会动的页面，必然有一个状态来控制，状态更新了，页面就会重新渲染。**在 React 中，有且只有一种途径来引入状态，那就是使用 Hook**。

对于初学者，使用 `useState` 这个 Hook 来引入状态就足够了，如果你想知道这些 Hook 做了什么，如何安排这些 hook，可以去看本系列 03 的内容。

例如以下组件：  

```jsx
const Component = () => {
  return (
    <div id="counter" onClick={() => {}}>
      {count}
    </div>
  );
};
```

Hook 引入了一种直观的方式来让函数拥有状态：

```jsx
import { useState } from "react";
...
const Component = () => {
  const [count, setCount] = useState(0);
  return <div onClick={() => setCount(count + 1)}>{count}</div>;
};
```

这样就得以让一个页面拥有了状态，因此就能动起来。

**Hook 是现代React 的核心，对 Hook 的掌握甚至直接决定了你的工资（技术职称）。由于篇幅原因，这里讲 Hook 只能这样提一嘴，之后的课程会详细讲解。**
